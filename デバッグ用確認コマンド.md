# 個体管理デバッグ用確認コマンド

## システム状態確認

### Docker環境確認
```bash
docker-compose ps
```

### データベース接続確認
```bash
docker exec -i glasses_postgres psql -U glasses_user -d glasses_store_db -c "SELECT COUNT(*) FROM purchase_orders;"
```

### 発注データ確認
```bash
docker exec -i glasses_postgres psql -U glasses_user -d glasses_store_db -c "
SELECT 
    po.purchase_order_number as 発注番号,
    s.name as 仕入先,
    po.status as ステータス,
    poi.quantity as 数量,
    p.product_code as 商品コード,
    p.name as 商品名,
    p.management_type as 管理方式
FROM purchase_orders po
JOIN suppliers s ON po.supplier_id = s.id
JOIN purchase_order_items poi ON po.id = poi.purchase_order_id
JOIN products p ON poi.product_id = p.id
WHERE po.store_id = (SELECT id FROM stores WHERE store_code = 'STORE001')
ORDER BY po.order_date DESC;
"
```

### フレーム個体データ確認
```bash
docker exec -i glasses_postgres psql -U glasses_user -d glasses_store_db -c "
SELECT 
    f.serial_number as 個体番号,
    p.product_code as 商品コード,
    p.name as 商品名,
    f.color as 色,
    f.size as サイズ,
    f.status as ステータス,
    f.location as 保管場所
FROM frames f
JOIN products p ON f.product_id = p.id
WHERE f.store_id = (SELECT id FROM stores WHERE store_code = 'STORE001');
"
```

## API動作確認

### 認証トークン取得
```bash
TOKEN=$(curl -s -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"userCode":"manager001","password":"password","storeCode":"STORE001"}' \
  | grep -o '"token":"[^"]*"' | cut -d'"' -f4)
echo "Token: $TOKEN"
```

### 発注履歴API
```bash
curl -H "Authorization: Bearer $TOKEN" http://localhost:3001/api/purchase-orders/history
```

### フレーム個体API
```bash
curl -H "Authorization: Bearer $TOKEN" http://localhost:3001/api/frames
```

### 在庫サマリーAPI
```bash
curl -H "Authorization: Bearer $TOKEN" http://localhost:3001/api/frames/inventory-summary
```

## フロントエンドアクセス

### メインアクセス
- フロントエンド: http://localhost:3000
- 認証情報: manager001 / password / STORE001

### 各画面への直接アクセス
- 発注履歴: http://localhost:3000/purchase-orders/history
- 入庫管理: http://localhost:3000/receiving
- 個体管理: http://localhost:3000/individual-management

## ログ確認

### バックエンドログ
```bash
docker logs glasses_backend --tail 50
```

### フロントエンドログ
```bash
docker logs glasses_frontend --tail 50
```

## トラブルシューティング

### データベースリセット（テストデータ再投入）
```bash
cd /home/h-hiramitsu/projects/test_kokyaku
docker exec -i glasses_postgres psql -U glasses_user -d glasses_store_db < setup_individual_management_test.sql
```

### コンテナ再起動
```bash
docker-compose restart backend frontend
```